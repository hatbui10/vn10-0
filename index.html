<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Máy quét Axyz</title>

<style>
    body {
    font-family: monospace;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    padding: 30px;
    color: #eaeaea;
}

/* KHUNG CHÍNH */
.container {
    max-width: 760px;
    margin: auto;
    background: rgba(255,255,255,0.06);
    border-radius: 14px;
    padding: 20px 24px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    backdrop-filter: blur(6px);
}

/* TIÊU ĐỀ */
h3 {
    margin-top: 0;
    margin-bottom: 12px;
    letter-spacing: 1px;
}

/* INPUT BIT */
.inputs {
    display: grid;
    grid-template-columns: repeat(17, 34px);
    gap: 6px;
    margin-bottom: 16px;
}

input {
    width: 32px;
    height: 32px;
    text-align: center;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,0.2);
    background: rgba(0,0,0,0.4);
    color: #fff;
    outline: none;
    transition: all 0.15s ease;
}

input:focus {
    border-color: #4dabf7;
    box-shadow: 0 0 0 2px rgba(77,171,247,0.35);
    background: rgba(0,0,0,0.6);
}

/* MÀU A X Y */
.A {
    background: linear-gradient(135deg, #ff7aa2, yellow);
    color: #000;
}
.X {
    background: linear-gradient(135deg, #74c0fc, #dbe9ff);
    color: #000;
}
.Y {
    background: linear-gradient(135deg, #63e6be, #d6f5e3);
    color: #000;
}

/* NÚT */
button {
    margin: 8px;
    padding: 8px 22px;
    font-size: 14px;
    border-radius: 20px;
    border: none;
    cursor: pointer;
    color: #fff;
    background: linear-gradient(135deg, #845ef7, #5c7cfa);
    box-shadow: 0 8px 20px rgba(0,0,0,0.35);
    transition: all 0.2s ease;
}

button:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 26px rgba(0,0,0,0.45);
}

/* LỊCH SỬ */
#history {
    background: #f0f4f8;
    border: 1px solid #cbd5e1;
    border-radius: 10px;
    padding: 12px;
    max-height: 320px;
    overflow-y: auto;
}

/* mỗi Axyz */
.block {
    background: #ffffff;
    border-left: 5px solid #64748b;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}

/* tiêu đề Axyz */
.block b {
    color: #1e293b;
    font-size: 15px;
}

/* dòng Y cũ */
.block i {
    color: #475569;
    font-size: 13px;
}

/* hàng Y 5 ô */
.y-row {
    display: grid;
    grid-template-columns: repeat(5, 40px);
    gap: 4px;
    margin-top: 4px;
}

.y-cell {
    width: 40px;
    height: 40px;
    background: red;
    border: 1px solid #7dd3fc;
    border-radius: 4px;
    margin: 4px;
    display: flex;
    align-items: center;      /* căn dọc */
    justify-content: center;  /* căn ngang */
    font-size: 20px;
    font-weight: bold;
    color: #fff;
}


</style>
</head>

<body>


<div class="container">

    <h3>Dãy B (51 bit)</h3>
    <div class="inputs" id="inputs"></div>
    <h3>Dãy B (chuỗi dài)</h3>
<textarea id="longB" rows="4" style="width:100%;font-family:monospace"
placeholder="Dán chuỗi 0–1 dài ở đây (1000 bit cũng được)"></textarea>
<button onclick="calculateLong()">Quét chuỗi</button>

    <button onclick="calculate()">Tính</button>

    <h3>Lịch sử Axyz</h3>
    <div id="history"></div>

</div>


<script>
const inputsDiv = document.getElementById("inputs");
const historyDiv = document.getElementById("history");
const inputs = [];
const history = [];

/* ===== TẠO 51 Ô ===== */
for (let i = 0; i < 51; i++) {
    const inp = document.createElement("input");
    inp.maxLength = 1;

    inp.addEventListener("input", () => {
        if (!/^[01]$/.test(inp.value)) {
            inp.value = "";
            return;
        }

        if (i < 50) {
            inputs[i + 1].focus();
        } else {
            shiftLeft();
            inputs[50].focus();
        }
    });

    inputs.push(inp);
    inputsDiv.appendChild(inp);
}

window.onload = () => inputs[0].focus();

/* ===== DỊCH TRÁI ===== */
function shiftLeft() {
    clearColors();
    for (let i = 0; i < 50; i++) {
        inputs[i].value = inputs[i + 1].value;
    }
    inputs[50].value = "";
}

/* ===== LẤY B ===== */
function getB() {
    return inputs.map(i => i.value || "0").join("");
}

/* ===== MÀU ===== */
function clearColors() {
    inputs.forEach(i => i.classList.remove("A","X","Y"));
}

function colorRange(start, length, cls) {
    for (let i = start; i < start + length && i < 51; i++) {
        inputs[i].classList.add(cls);
    }
}

/* ===== TÍNH TOÀN BỘ Axyz ===== */
function calculate() {
    clearColors();

    const B = getB();
    const regex = /0{4,}1/g;
    let match;

    while ((match = regex.exec(B)) !== null) {

        const startA = match.index;
        const lenA   = match[0].length;
        const startX = startA + lenA;
        const startY = startX + 5;

        if (startY + 5 > B.length) break;

        const A = match[0];
        const X = B.slice(startX, startX + 5);
        const Y = B.slice(startY, startY + 5);
        const Z = B.slice(startY + 5);

        /* ===== TÔ MÀU ===== */
        colorRange(startA, lenA, "A");
        colorRange(startX, 5, "X");
        colorRange(startY, 5, "Y");

        /* ===== LƯU ===== */
        history.push({ A, X, Y, Z });
        const idx = history.length - 1;

        /* ===== Y CŨ (TỐI ĐA 5) ===== */
        let extraHtml = "";

if (idx > 0) {
    const prevY = history[idx - 1].Y;

    extraHtml = `
        <div>
            <i>Y (Axyz${idx})</i>
            <div class="y-row">
                ${prevY.split("").map(b => `
                    <div class="y-cell">${b}</div>
                `).join("")}
            </div>
        </div>
    `;
}

        /* ===== BLOCK ===== */
        const div = document.createElement("div");
        div.className = "block";
        div.innerHTML = `
            <b>Axyz${idx + 1}</b><br>
            A: ${A}<br>
            X: ${X}<br>
            ${extraHtml}
            Y: ${Y}<br>
            Z: ${Z}<br>
            
        `;

        historyDiv.prepend(div);
    }

    inputs[50].focus();
}

function calculateLong() {
    history.length = 0;
    historyDiv.innerHTML = "";

    const B = document.getElementById("longB").value
    .replace(/[^01]/g, "");

    if (!/^[01]+$/.test(B)) return;
    if (!/0{4,}1/.test(B)) {
    alert("Chuỗi không chứa mẫu Axyz (00001...)");
    return;
}


    const regex = /0{4,}1/g;
    let match;

    while ((match = regex.exec(B)) !== null) {
        const startA = match.index;
        const lenA   = match[0].length;
        const startX = startA + lenA;
        const startY = startX + 5;

        if (startY + 5 > B.length) break;

        const A = match[0];
        const X = B.slice(startX, startX + 5);
        const Y = B.slice(startY, startY + 5);
        const Z = B.slice(startY + 5);

        history.push({ A, X, Y, Z });
        const idx = history.length - 1;

        let extraHtml = "";
        if (idx > 0) {
            const prevY = history[idx - 1].Y;
            extraHtml = `
                <div>
                    <i>Y (Axyz${idx})</i>
                    <div class="y-row">
                        ${prevY.split("").map(b => `
                            <div class="y-cell">${b}</div>
                        `).join("")}
                    </div>
                </div>
            `;
        }

        const div = document.createElement("div");
        div.className = "block";
        div.innerHTML = `
            <b>Axyz${idx + 1}</b><br>
            A: ${A}<br>
            X: ${X}<br>
            ${extraHtml}
            Y: ${Y}<br>
            Z: ${Z}<br>
        `;

        historyDiv.prepend(div);
    }
}


</script>
</body>
</html>






