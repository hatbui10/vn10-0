<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Máy quét Axyz</title>

<style>
    body {
    font-family: monospace;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    padding: 30px;
    color: #eaeaea;
}

/* KHUNG CHÍNH */
.container {
    max-width: 760px;
    margin: auto;
    background: rgba(255,255,255,0.06);
    border-radius: 14px;
    padding: 20px 24px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.4);
    backdrop-filter: blur(6px);
}

/* TIÊU ĐỀ */
h3 {
    margin-top: 0;
    margin-bottom: 12px;
    letter-spacing: 1px;
}

/* INPUT BIT */
.inputs {
    display: grid;
    grid-template-columns: repeat(17, 34px);
    gap: 6px;
    margin-bottom: 16px;
}

input {
    width: 32px;
    height: 32px;
    text-align: center;
    font-size: 16px;
    border-radius: 6px;
    border: 1px solid rgba(255,255,255,0.2);
    background: rgba(0,0,0,0.4);
    color: #fff;
    outline: none;
    transition: all 0.15s ease;
}

input:focus {
    border-color: #4dabf7;
    box-shadow: 0 0 0 2px rgba(77,171,247,0.35);
    background: rgba(0,0,0,0.6);
}

/* MÀU A X Y */
.A {
    background: linear-gradient(135deg, #ff7aa2, #ffd6e7);
    color: #000;
}
.X {
    background: linear-gradient(135deg, #74c0fc, #dbe9ff);
    color: #000;
}
.Y {
    background: linear-gradient(135deg, #63e6be, #d6f5e3);
    color: #000;
}

/* NÚT */
button {
    margin: 8px;
    padding: 8px 22px;
    font-size: 14px;
    border-radius: 20px;
    border: none;
    cursor: pointer;
    color: #fff;
    background: linear-gradient(135deg, #845ef7, #5c7cfa);
    box-shadow: 0 8px 20px rgba(0,0,0,0.35);
    transition: all 0.2s ease;
}

button:hover {
    transform: translateY(-1px);
    box-shadow: 0 12px 26px rgba(0,0,0,0.45);
}

/* LỊCH SỬ */
#history {
    margin: 26px;
}

.block {
    background: rgba(255,255,255,0.08);
    border-radius: 10px;
    padding: 10px 14px;
    margin-top: 10px;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.1);
    animation: fadeIn 0.25s ease;
}

/* ANIMATION NHẸ */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(6px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}


.prevY {
    display: flex;
    gap: 4px;
    margin-top: 6px;
}

.prevY span {
    width: 26px;
    height: 26px;
    line-height: 26px;
    text-align: center;
    border-radius: 5px;
    background: rgba(255,255,255,0.15);
    box-shadow: inset 0 0 0 1px rgba(255,255,255,0.25);
    font-size: 14px;
}

</style>
</head>

<body>


<div class="container">

    <h3>Dãy B (51 bit)</h3>
    <div class="inputs" id="inputs"></div>

    <button onclick="calculate()">Tính</button>

    <h3>Lịch sử Axyz</h3>
    <div id="history"></div>

</div>


<script>
const inputsDiv = document.getElementById("inputs");
const historyDiv = document.getElementById("history");
const inputs = [];
let historyIndex = 1;

// Tạo 51 ô input
for (let i = 0; i < 51; i++) {
    const inp = document.createElement("input");
    inp.maxLength = 1;

    inp.addEventListener("input", () => {
        if (!/^[01]$/.test(inp.value)) {
            inp.value = "";
            return;
        }

        if (i < 50) {
            inputs[i + 1].focus();
        } else {
            shiftLeft();
            inputs[50].focus();
        }
    });

    inputs.push(inp);
    inputsDiv.appendChild(inp);
}

window.onload = () => inputs[0].focus();

function shiftLeft() {
    clearColors();
    for (let i = 0; i < 50; i++) {
        inputs[i].value = inputs[i + 1].value;
    }
    inputs[50].value = "";
}

function getB() {
    return inputs.map(i => i.value || "0").join("");
}

function clearColors() {
    inputs.forEach(i => i.classList.remove("A","X","Y"));
}

function colorRange(start, length, cls) {
    for (let i = start; i < start + length && i < 51; i++) {
        inputs[i].classList.add(cls);
    }
}

let lastY = null; // lưu Y của Axyz trước

function calculate() {
    clearColors();

    const B = getB();
    const regex = /0{4,}1/g;
    let match;

    while ((match = regex.exec(B)) !== null) {
        const startA = match.index;
        const lenA = match[0].length;
        const startX = startA + lenA;
        const startY = startX + 5;

        // tô màu input
        colorRange(startA, lenA, "A");
        colorRange(startX, 5, "X");
        colorRange(startY, 5, "Y");

        const A = match[0];
        const X = B.slice(startX, startX + 5);
        const Y = B.slice(startY, startY + 5);
        const Z = B.slice(startY + 5);

        // tạo block lịch sử
        const div = document.createElement("div");
        div.className = "block";

        let prevYHtml = "";
        if (lastY) {
            prevYHtml = `
                <div class="prevY">
                    ${lastY.split("").map(b => `<span>${b}</span>`).join("")}
                </div>
            `;
        }

        div.innerHTML = `
    <b>Axyz${historyIndex}</b><br>
    A: ${A}<br>
    X: ${X}<br>
    Y: ${Y}<br>
    Z: ${Z}
    ${prevYHtml ? `<div><i>Y trước đó:</i>${prevYHtml}</div>` : ""}
`;

        historyDiv.prepend(div);

        lastY = Y;          // cập nhật Y cho vòng sau
        historyIndex++;
    }

    inputs[50].focus();
    
}
</script>

</body>
</html>

